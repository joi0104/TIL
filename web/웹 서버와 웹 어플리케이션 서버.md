### 웹 서버?

- 클라이언트의 요청을 받아 정적 페이지를 제공하는 서버
- 대표적으로 `apache`, `nginx`, `IIS`가 존재한다.

### 정적 페이지? 동적 페이지?

![](http://i0.wp.com/lh3.googleusercontent.com/-mFaOm0EGIvA/VqeJYe_b_yI/AAAAAAAAADA/FDiCN9Zp_hg/w720-o/static-vs-dynamic-web-inside.png?w=734&ssl=1)

- 정적 페이지: 변경될 가능성이 없는 정적 데이터들로 이루어진 페이지
- 동적 페이지: 유동적으로 변경되는 동적 데이터들을 가공하여 생성하는 페이지

### 그럼 웹 서버는 동적 페이지를 제공할 수 없나?

- `apache`나 `nginx`의 모듈로 제공할 수 있다.
- 예를 들어, `apache`와 `php`, `mysql`을 연동시키서 동적인 php 웹사이트를 제공하는 방식이 존재 (APM)
- `apache`에 php 코드를 읽을 수 있는 모듈을 셋팅해놓으면 웹 접근이 있을 때마다, `apache`는 php 코드를 읽어 정적인 데이터로 변환해서 웹사이트를 제공한다.

### 하지만 웹 서버만 두진 않는다.

- WAS 서버를 두고 웹서버는 이러한 WAS 서버와 client를 중계하는 서버로 사용하기도 한다.

### WAS?

- 웹 어플리케이션 서버
- 동적인 데이터들을 전문적으로 처리해서 정적인 데이터로 가공주는 서버
- 대표적으로 `tomcat`, `weblogic`, `websphere `, `jeus`가 존재한다.

### apache의 모듈로도 할 수 있지않나?

- 스프링와 같은 좀 더 고도화된 프레임워크에서는 한계가 존재한다. 따라서 해당 프레임워크에 적합한 전문 서버가 필요하다.

### 그럼 nodejs, django 은 뭔가?

- 진영마다 배포 구조들도 달라서 다른 진영에서는 딱히 어떤것이 WAS 역할이다. 라고 구분해서 용어를 사용하지는 않는다.
- `nodejs`: WAS를 제공하는 것으로 보인다.
- `django`: `gunicon`을 통해서 WSGL를 제공하는 것으로 보인다.

### 다시 돌아와서..

![](http://myblog.opendocs.co.kr/wp-content/uploads/2014/09/동적-웹페이지-1024x304.png)

- 그래서 요즘에는 앞단에 웹서버를 두고 그 뒤에 WAS를 두어서 전문적인 데이터 처리는 WAS에게 넘겨두고,
- 웹서버는 WAS를 통해 받은 정적인 데이터를 처리하여 페이지로 client에게 제공한다.

### 왜 이런 구조로 서버를 구성할까?

- 물론 WAS도 동적 페이지를 생성하여 전달하거나 정적 리소스를 전달할 수 있다.
- 하지만 그렇게 하지 않는 이유는?
- ~~정적 리소스를 제공하는 속도가 느리다~~. 하지만 이것도 예전 이야기..
- 웹 서버가 `reverse proxy` , `load balancer` 역할을 할 수 있기 때문에!

### reverse proxy?

- `forward proxy` : 서버에 방문하는 client가 자신의 주소를 숨기기 위해 프록시를 두고 프록시를 통해서 서버에 접근하는 것
- `reverse proxy` : 반대로, client에게 서버의 정보를 감추는 것
- 왜 감추나? 보안상 내부 구조를 감출 필요가 있다. 서버 내부의 파일이 어디 존재하는지 서비스가 몇번 포트에서 돌고있는 지 등등의 정보를 노출하는 것은 위험하다.
- 또한 `reverse proxy` 는 캐시기능을 제공한다.
- 캐시? client들의 요청들이 proxy에 쌓여있다가 비슷한 요청이 들어왔을때, 서버를 거치치 않고 바로 응답을 할 수 있는 것

### load balancer?

- 여러개의 WAS 인스턴스가 돌고 있을때, client의 요청을 균일하게 분산해서 각 서버에게 전달하는 것

### 잠깐! 왜 WAS가 여러개 돌고있지?

- 지속성을 위해서. 동적 데이터의 업데이트가 있는 경우, 돌던 서비스를 멈추고 다시 실행해야 한다. 이 짧은 찰나에 client가 접속하면 서버가 꺼져있기 때문에 오류가 뜬다.
- 즉, 하나의 WAS가 재부팅 중일때에는 `load balancer`가 client들을 다른 WAS로 보낸다.
- 또한, WAS를 여러개 두어서 한 WAS가 너무 많은 작업을 처리하지 않도록 하여 성능을 개선시킬수도 있다.

### 이외에도..

- 이외에도 웹 서버는 많은 모듈듈을 사용해서 WAS가 정상작동하는지 주기적으로 헬스체크 하는 등 서비스를 안정적이고 안전하게 돌리기 위한 다양한 기능을 제공한다.

### 정리하자면!

- 웹 서버와 WAS가 하는 작업중 겹치는 것들도 존재하지만, 각자 특화된 부분들을 가지고 있다.
- 이를 활용해서 웹 서버는 앞단에 WAS는 뒷단에 두도록 구성하여 서비스를 보다 안전하고 안정적이게 제공할 수 있다.

### 다음에는

- 그렇다면 웹 서버의 가장 대표적인 `apache` 와 `nginx` 의 차이는 무엇일까?
